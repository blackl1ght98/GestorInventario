version: '3.4'

services:
  gestorinventario:
    container_name: gestor-inventario
    image: ${DOCKER_REGISTRY-}gestorinventario
    build:
      context: .
      dockerfile: GestorInventario/Dockerfile
    ports:
      - "28907:8080"
      - "8080:8080"
      - "8081:8081"
      - "28908:8081"
    environment:
      - DB_HOST=SQL-Server-Local
      - DB_NAME=GestorInventario
      - DB_SA_PASSWORD=SQL#1234
      - IS_DOCKER=true
      - USE_REDIS=true 
      - ASPNETCORE_Kestrel__Certificates__Default__Password=password
      - ASPNETCORE_Kestrel__Certificates__Default__Path=/https/aspnetapp.pfx
      - ClaveJWT=${ClaveJWT}
      - REDIS_CONNECTION_STRING=${REDIS_CONNECTION_STRING} 
      - JwtIssuer=${JwtIssuer}
      - JwtAudience=${JwtAudience}
      - JWT_PublicKey=${PublicKey}
      - JWT_PrivateKey=${PrivateKey} 
    volumes:
      - /c/Users/guill/.aspnet/https:/https:ro
      - appdata:/app/data

  redis:
    image: redis:latest
    container_name: redis
    ports:
      - "6379:6379"
    volumes:
      - redisdata:/data

volumes:
  appdata:
    driver: local
  redisdata:
    driver: local
